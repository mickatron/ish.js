{"version":3,"sources":["ish.js"],"names":["ish","document","window","$","extendProp","targetObject","toMerge","prop","propValue","undefined","constructor","Object","Array","isArray","extend","ishObject","forEach","createElement","selector","context","forceSelector","found","Node","length","nodesFound","i","querySelectorAll","el","push","obj","create","n","fn","nth","int","this","scope","s","len","call","indexOf","needle","item","attr","name","value","returnVal","setAttribute","getAttribute","args","arguments","e","allKeys","getOwnPropertyNames","keyInx","splice","each","offset","ol","ot","offsetParent","offsetLeft","offsetTop","left","top","dimension","type","margins","excludeScrollBar","disp","target","style","display","height","mt","mb","css","parseInt","outerHeight","outerWidth","clientHeight","clientWidth","offsetHeight","offsetWidth","typeStr","lastIndex","character","charAt","toUpperCase","slice","toLowerCase","getComputedStyle","getPropertyValue","$el","on","event","delegate","node","matches","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","matchesSelector","elements","match","delegates","temp","f","delegateTarget","addEventListener","off","removeEventListener","evtfn","trigger","data","createEvent","initEvent","eventName","dispatchEvent","width","ajax","options","settings","url","success","error","headers","X-Requested-With","Content-Type","xhr","XMLHttpRequest","open","encodeURI","_successFn","_errorFn","_headers","setRequestHeader","onload","status","responseText","statusText","send","hasClass","addClass","removeClass","test","RegExp","className","newClass","replace","emitter","log","emit","argsObject","listeners","handler","subscribe","unsubscribe","index","flush","factory","_windowWidth","_windowHeight","_settings","onResizeFn","evt","setState","innerWidth","innerHeight","tempState","tempValueType","breakpoints","_widthValue","_heightValue","state","widthTest","isNaN","heightTest","_this","responsive","add","remove","responsiveObj","eventPrefix","destroy","resolveObjectPath","o","a","split","k","setPathByString","object","propertyString","props","store","states","createDataState","ref","actions","model","createComState","bindAttrName","noop","renderTemplate","templateString","dataObject","insertAdjacentHTML","nodesToBind","renderBind","rendered","removeChild","firstChild","updateTemplate","updateNode","updates","updateTemplateEachFn","domNode","binds","bind","domAttribute","trim","propertyAttribute","targetValue","resolvedPathValue","bindToObject","arrayFindString","str","strArray","values","j","callRouteFn","routeKey","slugs","stateData","routes","before","enter","after","parseURLroute","routeString","keys","routeKeys","wildcardKeys","filter","substr","exact","routeArray","shift","fnIndexMatches","fnKeyMatches","mostSimilar","refineMatch","mostPoints","newArr","points","val","notFound","route","console","getSlugs","current","routeFnObj","leave","leaveFn","d","previousRoute","hasSlugs","splitMatchArray","isSlug","slugName","slugValue","stateString","JSON","stringify","localStorage","setItem","_historyAPI","history","router","addRoute","removeRoute","flushRoutes","navigate","routeData","pushState","popHandler","historyState","parse","getItem","currentLocation","URL","baseURL","replaceState"],"mappings":"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","file":"ish.min.js","sourcesContent":["/** \r\n * \r\n * @fileoverview \r\n\r\n\r\nIsh.js(Alpha) is a super tiny Javascript library with a jQuery'ish syntax. [Visit the full documentation][docs].\r\n\r\n## Distributed files\r\n\r\nThere's two compiled files available in the dist folder.\r\n\r\n -   `ish.lite.min.js` is around 3KB and includes only the ish.core.js and ish.events.js methods. Minified it weighs in just under 3KB.\r\n -   `ish.min.js` weighs in at around 9kb and incldes all Ish.js library methods.\r\n\r\n### Compiling a custom version\r\n\r\nSee the 'Compiling a Custom Package Tutorial'.\r\n\r\n## Browser Support\r\n\r\n -   IE9+\r\n -   Firefox\r\n -   Chrome\r\n -   Safari\r\n\r\n## Mobile Support\r\nTBA\r\n\r\n## Installation &amp; Quick Start\r\n\r\nInstall with Git, NPM or Yarn. \r\n\r\n    // Git\r\n    $ git clone https://github.com/mickatron/ish.js.git\r\n    // NPM\r\n    $ npm i -D ish.js\r\n    // Yarn\r\n    $ yarn add ish.js --dev\r\n\r\n\r\nThen include the 'dist/ish.min.js' file on your html page and you're ready to go.\r\n\r\n    <script type=\"text/javascript\" src=\"/path/to/ish.min.js\">\r\n\r\n## Core Methods\r\n\r\n    // querySelectorAll based Selector Engine.\r\n    ish('selector','context');\r\n    \r\n    // Selector Engine Utilities.\r\n    ish('selector').nth();\r\n    ish('selector').indexOf();\r\n    ish('selector').forEach();\r\n    \r\n    // Basic Utils.\r\n    ish('selector').attr();\r\n    ish('selector').css();  \r\n    ish('selector').offset();  \r\n    ish('selector').dimension();\r\n    \r\n    // Event Methods.\r\n    ish('selector').on();\r\n    ish('selector').off();\r\n    ish('selector').trigger();\r\n    \r\n    // Library Utils.\r\n    ish.extends();\r\n\r\n## Optional Methods\r\nThis is not a full list, please see the full [documentation][docs] for all availiable methods.\r\n\r\n    // AJAX\r\n    ish.ajax();\r\n    \r\n    // ish().dimension Abstracts\r\n    ish('selector').width();\r\n    ish('selector').height();\r\n    \r\n    // Classname Utils.\r\n    ish('selector').hasClass();\r\n    ish('selector').addClass();\r\n    ish('selector').removeClass();\r\n    \r\n    //Responsive Util\r\n    ish.responsive();\r\n    //Routing\r\n    ish.router();\r\n    // Templating/rendering\r\n    ish.renderTemplate()\r\n    ish.updateTemplate()\r\n    ish.renderBind()\r\n    // State/Store\r\n    ish.store\r\n    \r\n\r\n\r\n\r\n## Tutorials\r\n - [Getting Started][tut1]\r\n - [Compiling a custom Ish.js package][tut2]\r\n - (Coming soon) Using the Responsive Utility\r\n - (Coming soon) Using the Tween Utility\r\n\r\n## Documentation\r\n[Visit the full documentation][docs]\r\n\r\n## Immediate To-dos;\r\n\r\n -  Error reporting.\r\n -  Improved Documentation and Theme   \r\n -  Improved testing\r\n -  review store/state component\r\n\r\n \r\n [docs]: http://ish.digitalfeast.com.au/js/docs\r\n [tut1]: http://ish.digitalfeast.com.au/js/docs/tutorial-Getting_Started.html\r\n [tut2]: http://ish.digitalfeast.com.au/js/docs/tutorial-Compiling_a_Custom_Package.html\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n */\r\n\r\n\r\n/**\r\n * @license\r\n * Copyright (c) 2016 Michael Hargreaves.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n * SOFTWARE.\r\n */\r\n\r\n\r\n\r\n\r\n/**\r\n * @namespace ish\r\n * @description A jQuery'ish set of utility methods. There is very few methods available under this namespace, the ish('selector') will by far be the most commonly used method. You'll also find an extends method and an optional AJAX utility.\r\n * @example\r\n(function($){\r\n\t// now you can use the $ sign in place of ish just as you would using jQuery.\r\n\t// Let's start by grabbing a reference to a DOM node with the selector engine\r\n\tvar $element = $('selector');\r\n\t// now we'll add the attribute 'data-ish' with a property of 'true'\r\n\t$element.attr('data-ish','true');\r\n\r\n\tvar obj1 = {a:'a'};\r\n\tvar obj2 = {a:'new a', b:'b'};\r\n\t$.extend(obj1,obj2);\r\n})(ish);\r\n */\r\nvar ish = function(document, window, $) {\r\n\t//'use strict';\r\n\t/* Lib Core\r\n\t---------------------------------------*/\r\n\tvar ishObject = {},\r\n\t\tforEach = 'forEach',\r\n\t\textend = 'extend',\r\n\t\t_window = window,\r\n\t\t_doc = document,\r\n\t\tdummy = document.createElement('i');\r\n\t\r\n\t\r\n\t/**\r\n\t * Simple selector engine based on <code>querySelectorAll</code>. The usage and result is similar to <code>jQuery(selector)</code>.\r\n\t * @name  ish\r\n\t * @augments ishObject\r\n\t * @function\r\n\t * @memberof ish\r\n\t * @param   {String|Node}   selector   A CSS Selector compatible with document.querySelectorAll or a single `Node`.\r\n\t * @param   {ishObject|Array|NodeList|Node} context  Used to give a selector a search context.\r\n\t * @param   {String} forceSelector    Set the ish('selector').selector paramter forcibly.\r\n\t * @return  {ishObject}                A list of nodes with inherited library methods.\r\n\t * @example\r\n\t * ish('selector');\r\n\t * //filter the collection with some context of type Node || NodeList\r\n\t * ish('selector', Node);\r\n\t * ish('selector', NodeList);\r\n\t */\r\n\tvar $ = function(selector, context, forceSelector) {\r\n\t\tcontext = context || document;\r\n\t\r\n\t\tvar found;\r\n\t\tif (selector instanceof Node || selector === window || selector === document) {\r\n\t\t\tfound = [selector];\r\n\t\t\tselector = forceSelector || selector;\r\n\t\t} else {\r\n\t\t\t// if context is an ishObject\r\n\t\t\tif (context.length) {\r\n\t\t\t\tfound = [];\r\n\t\t\t\tvar nodesFound;\r\n\t\t\t\tfor (var i = 0; i < context.length; i++) {\r\n\t\t\t\t\tnodesFound = context[i].querySelectorAll(selector || '☺');\r\n\t\t\t\t\t// might be able to improve this....\r\n\t\t\t\t\t// https://blog.jscrambler.com/12-extremely-useful-hacks-for-javascript\r\n\t\t\t\t\tfor (var el = 0; el < nodesFound.length; el++) {\r\n\t\t\t\t\t\tfound.push(nodesFound[el]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// querySelectorAll requires a string with a length\r\n\t\t\t\t// otherwise it throws an exception\r\n\t\t\t\tfound = context.querySelectorAll(selector || '☺');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar length = found.length;\r\n\t\tvar obj = Object.create(ishObject);\r\n\t\r\n\t\tfor (var n = 0; n < length; n++) {\r\n\t\t\tobj[n] = found[n]; // || found;\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t * The number of items found in the collection.\r\n\t\t * @memberOf ishObject\r\n\t\t * @name  length\r\n\t\t */\r\n\t\tobj.length = length;\r\n\t\t/**\r\n\t\t * The selector string as given when calling ish(selector, context, forceSelector). This value can be overridden if using the ish() forceSelector parameter.\r\n\t\t * @memberOf ishObject\r\n\t\t * @name  selector\r\n\t\t */\r\n\t\r\n\t\tobj.selector = selector;\r\n\t\t/**\r\n\t\t * The context as given when calling ish(selector, context).\r\n\t\t * @memberOf ishObject\r\n\t\t * @name  context\r\n\t\t */\r\n\t\tobj.context = context;\r\n\t\treturn obj;\r\n\t};\r\n\t\r\n\t/**\r\n\t * An object which stores prototype objects.\r\n\t * @memberOf ish\r\n\t * @name  ish.fn\r\n\t */\r\n\t$.fn = {\r\n\t\t/**\r\n\t\t * @mixin ish.fn.ishObject\r\n\t\t * @property {Number} length \tThe number of items returned in the collection.\r\n\t\t * @property {Number} context \tThe context item passed to the ish() selector engine.\r\n\t\t * @property {String} selector \tThe selector string passed to the ish() selector engine.\r\n\t\t * \r\n\t\t * @description\r\n\t\t * When you invoke the `ish('selector')` method `ish.fn.ishObject` members are inherited through Prototype Delegation to the returned collection.\r\n\t\t * The result is just like a jQuery Object, there is utility methods, a length, context and selector property.\r\n\t\t * \r\n\t\t * @example\r\n\t\t * // Cache an ishObject collection\r\n\t\t * var collection = ish('selector');\r\n\t\t * \r\n\t\t * // Call an ishObject method\r\n\t\t * ish('selector').attr('attributeName');\r\n\t\t * \r\n\t\t * // There is a length property\r\n\t\t * ish('selector').length; \r\n\t\t * \r\n\t\t * // and also a selector property which refers to the first parameter passed into ish();\r\n\t\t * ish('selector').selector;\r\n\t\t *\r\n\t\t * // You can call native methods on collection items just like you would in jQuery\r\n\t\t * ish('selector')[0].style.display = 'block';\r\n\t\t * \r\n\t\t */\r\n\t\tishObject: ishObject\r\n\t};\r\n\t\r\n\t/*\r\n\t//Returns true if it is a DOM node\r\n\tfunction isNode(o) {\r\n\t\treturn (\r\n\t\t\ttypeof Node === \"object\" ? o instanceof Node :\r\n\t\t\to && typeof o === \"object\" && typeof o.nodeType === \"number\" && typeof o.nodeName === \"string\"\r\n\t\t);\r\n\t}\r\n\t*/\r\n\t/**\r\n\t * Returns the item at the specified index in the `ishObject`.\r\n\t * @name  ish.fn.ishObject.nth\r\n\t * @function\r\n\t * @param  {Number} int    The index of the item in the `ishObject`.\r\n\t * @example\r\n\t * ish('selector').nth(0); //gets the first node\r\n\t */\r\n\t\r\n\tishObject.nth = function(int) {\r\n\t\treturn $(this[int], null, this.selector);\r\n\t};\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Iterates an `ishObject` returning each `Node` in an individual `ishObject`, along with its index \r\n\t * in the original collection. This method will iterate every item in the collection and cannot be broken.\r\n\t * @name  ish.fn.ishObject.forEach\r\n\t * @function\r\n\t * @param  {Function} fn    The callback function which will be called with each iteration\r\n\t * @param  {Object}   scope The scope in which the callback function will be called. \r\n\t * @return {ishObject}        Returns the `ishObject` which called it. Method is chainable. \r\n\t * @example\r\n\t * ish('selector', function( $item, index ) {\r\n\t *     //iterates the collections Dom Nodes, cannot be broken out of.    \r\n\t * });\r\n\t */\r\n\tishObject[forEach] = function(fn, scope) {\r\n\t\tscope = scope || this;\r\n\t\tvar i = 0,\r\n\t\t\ts,\r\n\t\t\tlen = this.length;\r\n\t\tfor (i; i < len; i++) {\r\n\t\t\ts = $(this[i], null, this.selector);\r\n\t\t\tfn.call(scope, s, i);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t/**\r\n\t * Gets the index of a specific `Node` in an `ishObject`\r\n\t * @name  ish.fn.ishObject.indexOf\r\n\t * @function\r\n\t * @param  {Node} needle    The `Node` to find in the `ishObject`.\r\n\t * @return {Number}         Index of the `Node` in the `ishObject`. Returns -1 if not found.\r\n\t * @example\r\n\t * ish('selector').indexOf(Node);\r\n\t */\r\n\tishObject.indexOf = function(needle) {\r\n\t\tvar i = 0,\r\n\t\t\tlen = this.length;\r\n\t\r\n\t\tfor (i; i <= len; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif (item === needle) {\r\n\t\t\t\treturn i;\r\n\t\t\t} else if (!item) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//return this;\r\n\t};\r\n\t/**\r\n\t * Gets an attributes value for the first element in the `ishObject`. If the second argument is supplied the \r\n\t * method sets an attribute and its value on all `Node`'s in the given `ishObject`. Prototyped method and properties are shadowed in the new object.\r\n\t * @name  ish.fn.ishObject.attr\r\n\t * @function\r\n\t * @param  {String} name        A valid CSS attribute selector.\r\n\t * @param  {String} value       The attirbute value to be set.\r\n\t * @return {ishObject|String}     If setting an attribute the method returns the `ishObject` which called it \r\n\t * and is chainable. If getting an attribute value the method will return the value found or undefined if \r\n\t * it's not found.\r\n\t * @example\r\n\t * ish('selector').attr('attribute-name'); //get an attribute value\r\n\t * ish('selector').attr('attribute-name','attribute-value'); //set an attribute value\r\n\t */\r\n\tishObject.attr = function(name, value) {\r\n\t\tvar returnVal;\r\n\t\tif (typeof value === \"string\") {\r\n\t\t\tthis[forEach](function(el) {\r\n\t\t\t\tel[0].setAttribute(name, value);\r\n\t\t\t});\r\n\t\t\treturnVal = this;\r\n\t\t} else if (this[0]) {\r\n\t\t\treturnVal = this[0].getAttribute(name);\r\n\t\t}\r\n\t\treturn returnVal;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Accepts a series objects, merging the second parameter into the first recursively, if more than two objects are supplied the other objects are merged into the first in the order given.\r\n\t * @name  ish#extend\r\n\t * @function\r\n\t * @param  {Object} object1 An `Object` that will have values of object2 recursively merged.\r\n\t * @param  {Object} [,obectj2] A series of `Objects` to merge into object1.\r\n\t * @return {Object}         A merged `Object`.\r\n\t * @example\r\n\t * var obj1 = {a:'a',b:{ba:'ba',bb:'bb',bc:{bca:'bca'}},c:[1,2,3]};\r\n\t * var obj2 = {d:'d',b:{ba:'ba-change',bc:{bcb:'added'}},c:[4,5,6]};\r\n\t * ish.extend(obj1,obj2);\r\n\t */\r\n\t\r\n\tfunction extendProp (targetObject, toMerge, prop){\r\n\t\tvar propValue = toMerge[prop];\r\n\t\tif (propValue === null || propValue === undefined) {\r\n\t\t\treturn; // skip null and undefined values\r\n\t\t} else if (propValue.constructor === Object || Array.isArray(propValue)) { // recurse objects that already exisit on the target\r\n\t\t\ttargetObject[prop] = $[extend](targetObject[prop] || {}, propValue);\r\n\t\t} else {\r\n\t\t\t/*var descriptor = Object.getOwnPropertyDescriptor(targetObject, prop);\r\n\t\t\tconsole.log('descriptor ',prop, descriptor, (typeof descriptor !== 'undefined' && descriptor.writable === 'true'), !targetObject[prop] );\r\n\t\t\t\r\n\t\t\tif((typeof descriptor !== 'undefined' && typeof descriptor.set !== 'undefined') || !targetObject[prop]) {\r\n\t\t\t\tconsole.log('extend ',prop);\r\n\t\t\t\ttargetObject[prop] = propValue;\r\n\t\t\t}*/\r\n\t\r\n\t\t\ttargetObject[prop] = propValue;\r\n\t\t}\r\n\t}\r\n\t$[extend] = function() {\r\n\t\tvar args = arguments;\r\n\t\tvar targetObject = args[0];\r\n\t\t// TODO: I dont think this will copy over any constructor prototypes implementations...\r\n\t\t// TODO: should I consider shallow copies?\r\n\t\tfor (var i = 1; i < args.length; i++) {\r\n\t\t\tvar toMerge = args[i];\r\n\t\t\tif(Array.isArray(targetObject)){\r\n\t\t\t\tvar newArray = [];\r\n\t\t\t\tfor (var e = 0; e < toMerge.length; e++) {\r\n\t\t\t\t\tif (toMerge[e] === null || toMerge[e] === undefined) {\r\n\t\t\t\t\t\tcontinue; // skip null and undefined values\r\n\t\t\t\t\t} else if (toMerge[e].constructor === Object ){ \r\n\t\t\t\t\t\ttargetObject[e] = $[extend](targetObject[e] || {}, toMerge[e]);\r\n\t\t\t\t\t} else if ( Array.isArray( toMerge[e])) {\r\n\t\t\t\t\t\ttargetObject[e] = $[extend](targetObject[e] || [], toMerge[e]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttargetObject[e]  = toMerge[e];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if(targetObject.constructor === Object){\r\n\t\t\t\t// all keys incuding non-enums\r\n\t\t\t\tvar allKeys = Object.getOwnPropertyNames(toMerge);\t\t\t\r\n\t\t\t\tfor (var prop in toMerge) {\r\n\t\t\t\t\tvar keyInx = allKeys.indexOf(prop);\r\n\t\t\t\t\tallKeys.splice(keyInx, 1);\r\n\t\t\t\t\textendProp (targetObject, toMerge, prop);\r\n\t\t\t\t}\r\n\t\t\t\t// extend any non-enumerable props left over\r\n\t\t\t\tfor (var each = 0; each < allKeys.length; each++) {\r\n\t\t\t\t\textendProp (targetObject, toMerge, allKeys[each]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn targetObject;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the left and top offset in pixels for the first element in the `ishObject`. \r\n\t * @name  ish.fn.ishObject.offset\r\n\t * @function\r\n\t * @return {Object}         An `Object` with values for left and top offsets in pixel values.\r\n\t * @example\r\n\t * ish('selector').offset();\r\n\t */\r\n\tishObject.offset = function() {\r\n\t\tvar ol = 0;\r\n\t\tvar ot = 0;\r\n\t\tif (this[0].offsetParent) {\r\n\t\r\n\t\t\tol = this[0].offsetLeft;\r\n\t\t\tot = this[0].offsetTop;\r\n\t\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tleft: ol,\r\n\t\t\ttop: ot\r\n\t\t};\r\n\t};\r\n\t\r\n\t/**\r\n\t * Gets the width or height the first element in the supplied `ishObject`.\r\n\t * @name  ish.fn.ishObject.dimension\r\n\t * @function\r\n\t * @param  {String} type          'width' or 'height'.\r\n\t * @param  {Boolean} margins      Include margins in the return result.\r\n\t * @param  {Boolean} excludeScrollBar Exclude the scrollbars width/height from the result.\r\n\t * @return {Integer}              The height of the element.\r\n\t * @example\r\n\t * ish('selector').width();\r\n\t */\r\n\tishObject.dimension = function(type, margins, excludeScrollBar) {\r\n\t\tvar disp;\r\n\t\tvar target = this[0];\r\n\t\tif (this.selector !== (window || document)) {\r\n\t\t\tdisp = target.style.display;\r\n\t\t\tif (disp === 'none') target.style.display = 'block';\r\n\t\t}\r\n\t\tvar height = 0;\r\n\t\tvar mt = 0;\r\n\t\tvar mb = 0;\r\n\t\tif (margins) {\r\n\t\t\tmt = type === 'height' ? this.css('marginTop') : this.css('marginLeft');\r\n\t\t\tmb = type === 'height' ? this.css('marginBottom') : this.css('marginRight');\r\n\t\t\theight = parseInt(mt) + parseInt(mb);\r\n\t\t}\r\n\t\tif (target === window) {\r\n\t\t\theight += type === 'height' ? target.outerHeight : target.outerWidth;\r\n\t\t} else if (excludeScrollBar) {\r\n\t\t\theight += type === 'height' ? target.clientHeight : target.clientWidth;\r\n\t\t} else {\r\n\t\t\theight += type === 'height' ? target.offsetHeight : target.offsetWidth;\r\n\t\t}\r\n\t\tif (this.selector !== (window || document) && disp === 'none') {\r\n\t\t\ttarget.style.display = 'none';\r\n\t\t}\r\n\t\treturn height;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Gets the CSS value of the first element in the supplied `ishObject`. Or sets the CSS value on all items in an `ishObject`.\r\n\t * @name  ish.fn.ishObject.css\r\n\t * @function\r\n\t * @param  {String} prop   The name of the CSS property in camelCase. eg. 'margin-left' would be passed as 'marginLeft'.  \r\n\t * @param  {String} value   Exclude the horizontal scrollbars height from the result.\r\n\t * @return {ishObject}       Returns the `ishObject` which called it. Method is chainable. \r\n\t * @example\r\n\t * ish('selector').css();\r\n\t */\r\n\tishObject.css = function(prop, value) {\r\n\t\tif(typeof prop === 'object') {\r\n\t\t\tfor(var each in prop) {\r\n\t\t\t\tthis.css(each, prop[each]);\r\n\t\t\t}\r\n\t\t} else if (!value) {\r\n\t\t\t//get the style\r\n\t\t\tvar typeStr = prop;\r\n\t\t\tvar lastIndex = 0;\r\n\t\t\tfor(var i = 0; i < prop.length; i++) {\r\n\t\t\t\tvar character = prop.charAt(i);\r\n\t\t\t\t\r\n\t\t\t\tif(character === character.toUpperCase()) {\r\n\t\t\t\t\ttypeStr = prop.slice(lastIndex, i) + '-' + prop.slice(i).toLowerCase();\r\n\t\t\t\t\tlastIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar value = this[0].style[prop] || window.getComputedStyle(this[0]).getPropertyValue(typeStr);\r\n\t\t\treturn value;\r\n\t\t} else {\r\n\t\t\t// set the style\r\n\t\t\tthis[forEach](function($el) {\r\n\t\t\t\t$el[0].style[prop] = value;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t//=require ish.core.js\r\n\t/**\r\n\t * Attach handlers to the Node/s in the given ishObject. This method is just a wrapper for 'addeventListener' so any valid Javascript event can be used. \r\n\t * It's inclusion in the library is intended to save you writing loops to cover multiple event targets when hooking events.\r\n\t * @name  ish.fn.ishObject.on\r\n\t * @function\r\n\t * @param  {String}   event     The type of event you're adding to the Node/s\r\n\t * @param  {Function} fn        A callback to be fired when the event is triggered.\r\n\t * @param  {String}   delegate  A valid CSS selector to delegate the event to.\r\n\t * @return {ishObject}            Method is chainable, returns the ish Object which called the method. \r\n\t * @example\r\n\t * var fn = function(event) {\r\n\t *     //mousedown event\r\n\t * };\r\n\t * ish('selector').on('mousedown', fn);\r\n\t */\r\n\t\r\n\tishObject.on = function(event, fn, delegate) {\r\n\t\r\n\t\tif (delegate) {\r\n\t\t\tthis[forEach](function(el) {\r\n\t\t\t\tvar node = el[0];\r\n\t\t\t\tvar matches = node.mozMatchesSelector || node.webkitMatchesSelector || node.oMatchesSelector || node.matchesSelector || (function(delegate) {\r\n\t\r\n\t\t\t\t\tvar target = node,\r\n\t\t\t\t\t\telements = $(delegate),\r\n\t\t\t\t\t\tmatch = false;\r\n\t\t\t\t\telements[forEach](function($el) {\r\n\t\t\t\t\t\tif ($el[0] === target) match = true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn match;\r\n\t\t\t\t});\r\n\t\t\t\t//store an array on the node with the delgate function data.\r\n\t\t\t\t// we'll call on this data in the undelgate methods\r\n\t\t\t\tnode.delegates = node.delegates || [];\r\n\t\t\t\tvar temp = {\r\n\t\t\t\t\tf: fn,\r\n\t\t\t\t\te: function(event) {\r\n\t\t\t\t\t\tif (matches.call(event.target, delegate)) {\r\n\t\t\t\t\t\t\tevent.delegateTarget = this;\r\n\t\t\t\t\t\t\tfn.call(this,event);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tnode.delegates.push(temp);\r\n\t\t\t\tnode.addEventListener(event, temp.e);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis[forEach](function(el) {\r\n\t\t\t\tel[0].addEventListener(event, fn, false);\r\n\t\t\t}, this);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Dettach handlers to the Node/s in the given ishObject. This method is just a wrapper for 'removeEventListener' so any valid Javascript event can be used. \r\n\t * Its inclusion in the library is intended to save you writing loops to cover multiple event targets when hooking events.\r\n\t * @name  ish.fn.ishObject.off\r\n\t * @function\r\n\t * @param  {string} event The type of event you're adding to the Node/s\r\n\t * @param  {function} fn The Node to find in the ish Object.\r\n\t * @return {ishObject}         Method is chainable, returns the ish Object which called the method. \r\n\t * @example\r\n\t * var fn = function(event) {\r\n\t *     //mousedown event\r\n\t * };\r\n\t * ish('selector').on('mousedown', mousedownHandler); //on\r\n\t * ish('selector').off('mousedown', fn); //off\r\n\t */\r\n\tishObject.off = function(event, fn) {\r\n\t\r\n\t\tthis[forEach](function(el) {\r\n\t\t\t// remove listeners from the element\r\n\t\t\tel[0].removeEventListener(event, fn, false);\r\n\t\t\t// remove any delegate listeners\r\n\t\t\tvar delegates = el[0].delegates;\r\n\t\t\t// if there's delegates loop each of them\r\n\t\t\tif (delegates)\r\n\t\t\t\tdelegates[forEach](function(evtfn, i) {\r\n\t\t\t\t\t// check for matches\r\n\t\t\t\t\tif (evtfn.f === fn) {\r\n\t\t\t\t\t\tel.off(event, evtfn.e);\r\n\t\t\t\t\t\tel[0].delegates.splice(i - 1, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t});\r\n\t\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Triggers an event.\r\n\t * @name  ish.fn.ishObject.trigger\r\n\t * @function\r\n\t * @param  {string} type The type of event to trigger.\r\n\t * @param  {object} data Any \r\n\t * @return {ishObject}         Method is chainable, returns the ish Object which called the method. \r\n\t * @example\r\n\t * var fn = function(event) {\r\n\t *     //mousedown event\r\n\t * };\r\n\t * ish('selector').on('mousedown', fn); //on\r\n\t * ish('selector').trigger('mousedown'); //fires mousedown\r\n\t */\r\n\tishObject.trigger = function(type, data) {\r\n\t\tthis[forEach](function(el) {\r\n\t\t\t// construct an HTML event. This could have\r\n\t\t\t// been a real custom event\r\n\t\t\tvar event = document.createEvent('HTMLEvents');\r\n\t\t\tevent.initEvent(type, true, true);\r\n\t\t\tevent.data = data || {};\r\n\t\t\tevent.eventName = type;\r\n\t\t\t//event.target = el;\r\n\t\t\tel[0].dispatchEvent(event);\r\n\t\r\n\t\r\n\t\t\t//el[trigger](event);\r\n\t\t});\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/* Lib Optional\r\n\t---------------------------------------*/\r\n\t/**\r\n\t * Gets the height of the first element in the supplied `ishObject`. This method is an abstraction of `ishObject.dimension`.\r\n\t * @name  ish.fn.ishObject.height\r\n\t * @function\r\n\t * @param  {Boolean} margins      Include margins in the return result.\r\n\t * @param  {Boolean} clientHeight Exclude the horizontal scrollbars height from the result.\r\n\t * @return {Integer}              The height of the element.\r\n\t * @example\r\n\t * ish('selector').height();\r\n\t */\r\n\tishObject.height = function(margins, clientHeight) {\r\n\t\treturn this.dimension('height', margins, clientHeight);\r\n\t};\r\n\t/**\r\n\t * Gets the width of the first element in the supplied `ishObject`. This method is an abstraction of `ish.fn.ishObject.dimension`.\r\n\t * @name  ish.fn.ishObject.width\r\n\t * @function\r\n\t * @param  {Boolean} margins      Include margins in the return result.\r\n\t * @param  {Boolean} clientHeight Exclude the horizontal scrollbars height from the result.\r\n\t * @return {Integer}              The height of the element.\r\n\t * @example\r\n\t * ish('selector').width();\r\n\t */\r\n\tishObject.width = function(margins, clientWidth) {\r\n\t\treturn this.dimension('width', margins, clientWidth);\r\n\t};\r\n\t/**\r\n\t * Make an XHR request. The implementation is currently very basic, the response is not parsed as JSON or converted to a String, you will have to do that to the response manually when it's returned. \r\n\t * @name  ajax\r\n\t * @function\r\n\t * @memberof ish\r\n\t * @param  {Object} options\r\n\t * @param  {String} options.type Acceptable values are; 'GET','POST','PUT','DELETE'.\r\n\t * @param  {String} options.url  The url of the request.\r\n\t * @param  {Function} options.success A callback function triggered when the ajax call is successful. The responseText is passed as the first parameter of the function, other values are availiable from the XMLHttpRequest Object returned from this component.\r\n\t * @param  {Function} options.error  A callback function triggered if the ajax call is unsuccessful.\r\n\t * @param  {Object} options.data A custom data object to pass with the request.\r\n\t * @param  {Object} options.headers An Object with String key values representing the header and its values. You can add custom header values here. \r\n\t * @param  {String} options.headers.Accept By default the Accept header is ommited although it is a common one to set so it gains a mention here. Common values are: `\"text/plain\"`, `\"text/html\"`, `\"application/xml, text/xml\"`, `\"application/json, text/javascript\"`\r\n\t * @param  {String} options.headers.Content-Type Default value is `'application/x-www-form-urlencoded'` other values often used are: `'text/plain'`, `'multipart/form-data'`, `'application/json'` or `'text/xml'`.\r\n\t * @param  {String} options.headers.X-Requested-With Default value is 'XMLHttpRequest'.\r\n\t * @return {ish}     Returns the XMLHttpRequest Object.\r\n\t * @example\r\n\t * var reqSuccess = function(data){\r\n\t * \t//success\r\n\t * \tconsole.log('success', data, req);\r\n\t * };\r\n\t * var reqError = function(statusText, status){\r\n\t * \t//error\r\n\t * \tconsole.log('There was an error. '+status+' : '+statusText, req);\r\n\t * };\r\n\t * \r\n\t * var req = ish.ajax({\r\n\t * \ttype:'JSON',\r\n\t * \turl: 'http://domain.com/ajaxhandler',\r\n\t * \tsuccess: reqSuccess,\r\n\t * \terror: reqError,\r\n\t * \tdata: {\"JSON\":\"data\"}\r\n\t * });\r\n\t */\r\n\t$.ajax = function(options) {\r\n\t\r\n\t\tvar settings = $.extend({\r\n\t\t\ttype: 'GET', // PUT OR JSON, GET, POST\r\n\t\t\turl: '',\r\n\t\t\tsuccess: null,\r\n\t\t\terror: null,\r\n\t\t\tdata: '',\r\n\t\t\theaders: {\r\n\t\t\t\t\"X-Requested-With\": 'XMLHttpRequest',\r\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t}\r\n\t\t}, options);\r\n\t\r\n\t\tvar xhr = new XMLHttpRequest();\r\n\t\txhr.open(settings.type, encodeURI(settings.url));\r\n\t\r\n\t\tvar _successFn = settings.success;\r\n\t\tvar _errorFn = settings.error;\r\n\t\t// SET REQUEST HEADERS\r\n\t\tvar _headers = settings.headers;\r\n\t\tfor ( var prop in _headers ) {\r\n\t\t\txhr.setRequestHeader(prop, _headers[prop]);\r\n\t\t}\r\n\t\t// Listen to ONLOAD EVENT\r\n\t\txhr.onload = function() {\r\n\t\t\tif (xhr.status === 200) {\r\n\t\t\t\tif(_successFn) _successFn( xhr.responseText );\r\n\t\t\t} else {\r\n\t\t\t\tif(_errorFn) _errorFn( xhr.statusText, xhr.status );\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\txhr.send(settings.data);\r\n\t\treturn xhr; // Theres no publics so just return the xhr obj.\r\n\t};\r\n\t//=require ish.core.js\r\n\t\r\n\tvar hasClass = 'hasClass',\r\n\t\taddClass = 'addClass',\r\n\t\tremoveClass = 'removeClass';\r\n\t\r\n\t/**\r\n\t * Tests if a particular class name is found on a Node within the given ishObject. \r\n\t * This method will check the whole collection, if you want to check a specific \r\n\t * selector you will be required to filter the collection before making the check.\r\n\t * @name ish.fn.ishObject.hasClass\r\n\t * @function\r\n\t * @param  {String} test \tThe class name to test against the collection.\r\n\t * @return {boolean}      \tIf the class name was found on the collection.\r\n\t * @example\r\n\t * ish('selector').hasClass('className');\r\n\t */\r\n\tishObject[hasClass] = function(test) {\r\n\t\tvar found = false;\r\n\t\tthis[forEach](function(el) {\r\n\t\t\tif (RegExp(' ' + test + ' ').test(' ' + el[0].className + ' ')) {\r\n\t\t\t\tfound = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn found;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Removes a class name from each Node in the given ishObject.\r\n\t * @name ish.fn.ishObject.removeClass\r\n\t * @function\r\n\t * @param  {String} name \tThe class name you wish to remove from the element/s. \r\n\t * @return {ishObject}      Returns the `ishObject` which called it. Method is chainable. \r\n\t * @example\r\n\t * ish('selector').removeClass('className');\r\n\t */\r\n\tishObject[removeClass] = function(name) {\r\n\t\tthis[forEach](function(el) {\r\n\t\t\tif (el.hasClass(name)) {\r\n\t\t\t\tvar newClass = ' ' + el[0].className.replace(/[\\t\\r\\n]/g, ' ') + ' ';\r\n\t\t\t\twhile (newClass.indexOf(' ' + name + ' ') >= 0) {\r\n\t\t\t\t\tnewClass = newClass.replace(' ' + name + ' ', ' ');\r\n\t\t\t\t}\r\n\t\t\t\tel[0].className = newClass.replace(/^\\s+|\\s+$/g, '');\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds a class name to each Node in the given ishObject.\r\n\t * @name ish.fn.ishObject.addClass\r\n\t * @function\r\n\t * @param  {string} name \tThe class name you wish to add to the element/s. \r\n\t * @return {ishObject}      Returns the `ishObject` which called it. Method is chainable. \r\n\t * @example\r\n\t * ish('selector').addClass('className');\r\n\t */\r\n\tishObject[addClass] = function(name) {\r\n\t\tthis[forEach](function(el) {\r\n\t\t\tif (!el.hasClass(name)) {\r\n\t\t\t\tel[0].className += ' ' + name; // just adding a space to the start of every name saves a little code and makes little difference in HTML.\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t};\r\n\t//!=include /js/ish.invoke.js // Deprecated, extra optional. needs removal before beta\r\n\r\n\t/* Lib Optional Components\r\n\t---------------------------------------*/\r\n\t//!=include /js/ish.easing.js // just if you really need them\r\n\t\r\n\t$.fn.emitter = {\r\n\t\tlog: [],\r\n\t\t/**\r\n\t\t * Emit an action or data to subcribers.\r\n\t\t * @memberOf ish.emitter\r\n\t\t * @param  {String}   type The name of the emission.\r\n\t\t * @param  {Object} argsObject   An Object of data to be passed with the emission.\r\n\t\t * @return {$.emitter} Chainable.        \r\n\t\t */\r\n\t\temit: function(type, argsObject){\r\n\t\t\tvar listeners = this.listeners[type];\r\n\t\t\tif(!listeners) return this;\r\n\t\t\tfor (var handler in listeners) {\r\n\t\t\t\tlisteners[handler].call(this, argsObject);\r\n\t\t\t}\r\n\t\t\tif($.fn.emitter.log !== false) $.fn.emitter.log.push({type: type, arguments: argsObject });\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Subcribe from an a specific emission.\r\n\t\t * @memberOf ish.emitter\r\n\t\t * @param  {String}   type The name of the emission type you are subscribing.\r\n\t\t * @param  {Function} fn   The function that you are subscribing.\r\n\t\t * @return {$.emitter} Chainable.        \r\n\t\t */\r\n\t\tsubscribe: function(type, fn){\r\n\t\t\tthis.listeners[type] = this.listeners[type] || [];\r\n\t\t\tthis.listeners[type].push(fn);\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Unsubcribe from an a specific emission.\r\n\t\t * @memberOf ish.emitter\r\n\t\t * @param  {String}   type The name of the emission type you are unsubscribing.\r\n\t\t * @param  {Function} fn   The function that you are unsubscribing.\r\n\t\t * @return {$.emitter} Chainable.        \r\n\t\t */\r\n\t\tunsubscribe: function(type, fn){\r\n\t\t\tvar listeners = this.listeners[type];\r\n\t\t\tif(listeners){\r\n\t\t\t\tvar index = listeners.indexOf(fn);\r\n\t\t\t\tlisteners.splice(index, 1);\r\n\t\t\t}\t\t\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Remove all subscribers from the emitter instance.\r\n\t\t * @memberOf ish.emitter\r\n\t\t * @return {$.emitter} Chainable.        \r\n\t\t */\r\n\t\tflush : function(){\r\n\t\t\tthis.listeners = {};\r\n\t\t\treturn this;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * A basic emitter factory.\r\n\t * @name  ish.emitter\r\n\t * @constructor\r\n\t * @return {emitter} An instance of the $.emitter\r\n\t */\r\n\t$.emitter = function(){\r\n\t\tvar factory = Object.create($.fn.emitter);\r\n\t\tfactory.listeners = {};\r\n\t\treturn factory;\r\n\t};\r\n\t//=require ish.core.js\r\n\t(function() {\r\n\t\tvar _settings = [];\r\n\t\tvar _state = [];\r\n\t\tvar _windowWidth;\r\n\t\tvar _windowHeight;\r\n\t\r\n\t\t// PRIVATES\r\n\t\tvar onResizeFn = function(evt) {\r\n\t\t\t//_windowWidth\r\n\t\t\tsetState();\r\n\t\t};\r\n\t\r\n\t\tvar setState = function() {\r\n\t\t\t_windowWidth = window.innerWidth;\r\n\t\t\t_windowHeight = window.innerHeight;\r\n\t\r\n\t\t\t_settings.forEach(function(el, i) {\r\n\t\t\t\tvar tempState;\r\n\t\t\t\tvar tempValueType; //width = 0 || height = 1\r\n\t\t\t\tel.breakpoints.forEach(function(obj, i) {\r\n\t\t\t\t\tvar name = obj.name;\r\n\t\t\t\t\tvar _widthValue = obj.width;\r\n\t\t\t\t\tvar _heightValue = obj.height;\r\n\t\t\t\t\tel.state = el.state || [];\r\n\t\t\t\t\tvar widthTest = !isNaN(_widthValue) && _windowWidth > _widthValue;\r\n\t\t\t\t\tvar heightTest = !isNaN(_heightValue) && _windowHeight > _heightValue;\r\n\t\r\n\t\t\t\t\tif (widthTest) {\r\n\t\t\t\t\t\ttempState = name;\r\n\t\t\t\t\t\ttempValueType = 0;\r\n\t\t\t\t\t} else if (heightTest) {\r\n\t\t\t\t\t\ttempState = name;\r\n\t\t\t\t\t\ttempValueType = 1;\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\tif (tempState && \r\n\t\t\t\t\ttempValueType !== null && \r\n\t\t\t\t\tel.state[tempValueType] !== tempState || \r\n\t\t\t\t\ttempState === '') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tel.state[tempValueType] = tempState;\r\n\t\r\n\t\t\t\t\t/**\r\n\t\t\t\t\t * An event/action emitted by ish.emitter.\r\n\t\t\t\t\t * @memberOf ish.responsive\r\n\t\t\t\t\t * @event onMediaBreak\r\n\t\t\t\t\t * @property {String} name The name of the breakpoint as defined in the options object.\r\n\t\t\t\t\t * @example\r\n\t\t\t\t\t * mediaBreaks.subscribe('onMediaBreak', function(data){\r\n\t\t\t\t\t * \t\tconsole.log('Media break: ',data.name);\r\n\t\t\t\t\t * });\r\n\t\t\t\t\t */\r\n\t\t\t\t\tel._this.break = el.state[tempValueType];\r\n\t\t\t\t\tel._this.emit('onMediaBreak', { name: el.state[tempValueType] } );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\t// EXPOSED PROTOTYPE\r\n\t\t$.fn.responsive = {\r\n\t\t\t/**\r\n\t\t\t * Add one or more breakpoints to the instance.\r\n\t\t\t * @param {Array} settings An Array containing breakpoint settings.\r\n\t\t\t * @return {ish.responsive}       Chainable, returns its own instance.\r\n\t\t \t * @memberOf ish.responsive\r\n\t\t\t */\r\n\t\t\tadd : function(settings) {\r\n\t\t\t\t_settings.push(settings);\r\n\t\t\t\tsetState();\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * Remove one or more breakpoint object from the instance.\r\n\t\t\t * @param {Array} settings  An Array containing breakpoint settings.\r\n\t\t\t * @return {ish.responsive}       Chainable, returns its own instance.\r\n\t\t\t * @memberOf ish.responsive\r\n\t\t\t */\r\n\t\t\tremove : function(settings) {\r\n\t\t\t\t_settings.forEach(function(el, i) {\r\n\t\t\t\t\tif (el === settings) _settings.splice(i, 1);\r\n\t\t\t\t});\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t};\r\n\t\t// set initial state and event handler\r\n\t\tsetState();\r\n\t\t$(window).on('resize', onResizeFn);\r\n\t})();\r\n\t\r\n\t\r\n\t/**\r\n\t * Calls an event when breakpoints are reached. Needs a prototypal review.\r\n\t * @name  ish.responsive\r\n\t * @constructor\r\n\t * @extends {ish.emitter}\r\n\t * @fires onMediaBreak\r\n\t * @param {object} options\r\n\t * @param {Array} options.breakpoints An Array of Objects where the key is the name of the breakpoint and the value is the value that breakpoint will be triggered.\r\n\t * @param {string} options.eventPrefix The prefix or namespace events will be called under. \r\n\t * @return {ish.responsive} The Responsive instances public API.\r\n\t * @example\r\n\tvar mediaBreaks = ish.responsive({\r\n\t\tbreakpoints: [{\r\n\t\t\tname: 'mobile',\r\n\t\t\twidth: 0\r\n\t\t}, {\r\n\t\t\tname: 'tablet',\r\n\t\t\twidth: 640\r\n\t\t}, {\r\n\t\t\tname: 'desktop',\r\n\t\t\twidth: 1024\r\n\t\t}],\r\n\t\teventPrefix: 'ish.responsive'\r\n\t});\r\n\tmediaBreaks.subscribe('onMediaBreak', function(data){\r\n\t\tconsole.log('Media break: ',data.name);\r\n\t});\r\n\t */\r\n\t\r\n\t$.responsive = function(options) {\r\n\t\r\n\t\tvar responsiveObj = Object.create($.fn.responsive);\r\n\t\tish.extend(responsiveObj, ish.emitter());\r\n\t\r\n\t\tvar _settings = $.extend({\r\n\t\t\t\t_this: responsiveObj,\r\n\t\t\t\tbreakpoints: [{\r\n\t\t\t\t\tname: 'mobile',\r\n\t\t\t\t\twidth: 0\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'tablet',\r\n\t\t\t\t\twidth: 640\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: 'desktop',\r\n\t\t\t\t\twidth: 1024\r\n\t\t\t\t}],\r\n\t\t\t\teventPrefix: 'ish.responsive'\r\n\t\t\t},\r\n\t\t\toptions || {});\r\n\t\r\n\t\t/**\r\n\t\t * Removes all breakpoints for the instance and returns null. We cannot destroy the module internally, but you can use the return value to null out your references if you wish. \r\n\t\t * @name  destroy\r\n\t\t * @memberOf ish.responsive\r\n\t\t * @return {null} Returns null;\r\n\t\t * @example\r\n\t\t * mediaBreaks.destroy();\r\n\t\t * \r\n\t\t */\r\n\t\tresponsiveObj.destroy = function() {\r\n\t\t\tresponsiveObj.remove(_settings);\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\r\n\t\tresponsiveObj.add(_settings);\r\n\t\t\r\n\t\treturn responsiveObj;\r\n\t};\r\n   \r\n    /* Lib Optional Components -- Application Development\r\n    ---------------------------------------*/\r\n\t/**\r\n\t * Resolves an Object path given in String format within the given Object.\r\n\t * @name  ish.resolveObjectPath\r\n\t * @function\r\n\t * @param  {Object} object      The object which contains the value you're attempting to resolve.\r\n\t * @param  {String} pathString  The path of the value which you are attempting to resolve.  \r\n\t * @return {Object}             The resolved value.\r\n\t * @example\r\n\t *\r\n\t * var object = {\r\n\t *     nested: {\r\n\t *         value : 'a nested value',\r\n\t *         array: [1,2,'third',4,5]\r\n\t *     }\r\n\t * };\r\n\t * \r\n\t * var value = ish.resolveObjectPath(object, 'nested.value'); // 'a nested value'\r\n\t * var arrayValue = ish.resolveObjectPath(object, 'nested.array[3]'); // 'third' \r\n\t * \r\n\t */\r\n\t$.resolveObjectPath = function(o, s) {\r\n\t    s = s.replace(/\\[(\\w+)\\]/g, '.$1'); // convert indexes to properties\r\n\t    s = s.replace(/^\\./, '');           // strip a leading dot\r\n\t    var a = s.split('.');\r\n\t    for (var i = 0, n = a.length; i < n; ++i) {\r\n\t        var k = a[i];\r\n\t        if (k in o) {\r\n\t            o = o[k];\r\n\t        } else {\r\n\t            return;\r\n\t        }\r\n\t    }\r\n\t    return o;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Sets an the value of an Object path given in String format within the given Object.\r\n\t * @name  ish.setPathByString\r\n\t * @function\r\n\t * @param  {Object} object      The object which contains the value you're attempting to set.\r\n\t * @param  {String} pathString  The path of the value which you are attempting to set.\r\n\t * @param  {value} value        The value you're attempting to set.\r\n\t * @return {Object}             The resolved value.\r\n\t * @example\r\n\t *\r\n\t * var object = { \r\n\t *     nested: { \r\n\t *         value : 'a nested value',\r\n\t *         array: [1,2,'third',4,5]\r\n\t *     }\r\n\t * };\r\n\t * \r\n\t * var value = ish.resolveObjectPath(object, 'nested.value'); // 'a nested value'\r\n\t * var arrayValue = ish.resolveObjectPath(object, 'nested.array[3]'); // 'third' \r\n\t * \r\n\t */\r\n\t$.setPathByString = function(object, propertyString, value){\r\n\t    //propertyString = propertyString.replace(/\\[(\\w+)\\]/g, '.$1'); // convert indexes to properties\r\n\t    //propertyString = propertyString.replace(/^\\./, '');           // strip a leading dot\r\n\t    var props = propertyString.split('.');\r\n\t    var obj = object;\r\n\t    for (var i = 0; i < props.length; i++) {\r\n\t        if( i === props.length -1) {\r\n\t            obj[props[i]] = value;\r\n\t            return obj[props[i]];\r\n\t        }\r\n\t        if(!obj[props[i]]) {\r\n\t            obj[props[i]] = {};\r\n\t        } \r\n\t        obj = obj[props[i]];\r\n\t    }\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * A state and data store.\r\n\t * @name ish.store\r\n\t * @namespace\r\n\t * @type {Object}\r\n\t */\r\n\t$.store = {\r\n\t\tdata: {},\r\n\t\tstates: {},\r\n\t\t/**\r\n\t\t * Flush the store of all data and state.\r\n\t\t * @memberOf ish.store\r\n\t\t * @return {$.store} Chainable.\r\n\t\t */\r\n\t\tflush: function(){\r\n\t\t\tthis.states = {};\r\n\t\t\tthis.data = {};\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Create a data object in the store.\r\n\t\t * @memberOf ish.store\r\n\t\t * @param  {String}   name The name of the data object to create.\r\n\t\t * @param  {Function} fn   The initialization function containing actions etc...\r\n\t\t * @return {Object}        The created data object.\r\n\t\t */\r\n\t\tcreateDataState: function(name, fn){\r\n\t\t\tvar ref = this.data[name] = $.emitter();\r\n\t\t\tref.actions = {};\r\n\t\t\tref.store = null;\r\n\t\t\tref.model = null; \r\n\t\t\tfn.call(ref);\r\n\t\t\treturn ref;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Create a state object in the store.\r\n\t\t * @memberOf ish.store\r\n\t\t * @param  {String}   name The name of the state object to create.\r\n\t\t * @param  {Function} fn   The initialization function containing actions etc...\r\n\t\t * @return {Object}        The created state object.\r\n\t\t */\r\n\t\tcreateComState: function(name, fn){\r\n\t\t\tif(typeof name === 'string' ){\r\n\t\t\t\tif(!this.states[name]) {\r\n\t\t\t\t\tthis.states[name] = [];\r\n\t\t\t\t}\r\n\t\t\t\tvar ref = $.emitter();\r\n\t\t\t\tref.actions = {};\r\n\t\t\t\tfn.call(ref);\r\n\t\t\t\tthis.states[name].push(ref);\r\n\t\t\t\treturn ref;\r\n\t\t\t} else {\r\n\t\t\t\tfn.call(name);\r\n\t\t\t\treturn name;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * The name of the HTML attribute used to specify bindings.\r\n\t * @memberOf ish\r\n\t * @name bindAttrName\r\n\t * @type {String}\r\n\t */\r\n\tvar bindAttrName = $.bindAttrName = \"ish-bind\";\r\n\tvar noop = document.createElement('div');\r\n\t\r\n\t/**\r\n\t * Render a template string with corresponding object data.\r\n\t * @name  ish.renderTemplate\r\n\t * @function\r\n\t * @param  {String}   templateString \tA valid HTML template string.\r\n\t * @param  {Object}   dataObject \t\tAn object whose values will be bound to the rendered HTML.\r\n\t * @return {Node}         The rendered HTML template `Node` which can be inserted into the DOM.\r\n\t * @example\r\n\t *\r\n\t * var template = '<div><p ish-bind=\"textContent:text\"></p></div>'\r\n\t * \r\n\t * ish.renderTemplate(template, {text: 'Text has been rendered.'});\r\n\t */\r\n\t$.renderTemplate = function (templateString, dataObject){\r\n\t\tnoop.insertAdjacentHTML('afterbegin', templateString);\r\n\t\tvar nodesToBind = $('['+bindAttrName+']',noop);\r\n\t\tnodesToBind.forEach(function(node){\r\n\t\t\t$.renderBind(node, dataObject);\r\n\t\t});\r\n\t\tvar rendered = noop.removeChild(noop.firstChild);\r\n\t\treturn rendered;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Update a template Node with a corresponding object data.\r\n\t * @name  ish.updateTemplate\r\n\t * @function\r\n\t * @param  {Node}     updateNode \tThe node to update, all child Node's will be updated.\r\n\t * @param  {Object}   updateObject \tAn object whose values will be updated in the provided HTML.\r\n\t * @return {ish}       \r\n\t * @example\r\n\t *\r\n\t * var template = '<div><p ish-bind=\"textContent:text\"></p></div>';\r\n\t * var renderedTemplate = ish.renderTemplate();\r\n\t * ish.updateTemplate(renderedTemplate, {});\r\n\t */\r\n\t$.updateTemplate = function (updateNode, updates){\r\n\t\t// TODO refactor, should sit outside of this fn\r\n\t\tvar updateTemplateEachFn = function(node){ $.renderBind(node, updates); };\r\n\t\tfor(var each in updates) {\r\n\t\t\t$('['+bindAttrName+'*=\"'+each+'\"]', updateNode).forEach(updateTemplateEachFn);\r\n\t\t}\r\n\t\treturn $;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Render the values given in the dataObject to a single node.\r\n\t * @name  ish.renderBind\r\n\t * @function\r\n\t * @param  {String}   domNode \t\tAn exisiting DOM Node.\r\n\t * @param  {Object}   dataObject \tAn object whose values will be bound to the rendered HTML.\r\n\t * @return {Node}     The rendered HTML template `Node` which can be inserted into the DOM.\r\n\t * @example\r\n\t *\r\n\t * var template = '<p ish-bind=\"textContent:text\"></p>'\r\n\t * var node = ish.renderTemplate(template, {text:'text has been rendered'});\r\n\t * // you would usualy use ish.updateTemplate, this is just for exmaple\r\n\t * ish.renderBind(node, {text: 'text has been updated text'});\r\n\t */\r\n\t$.renderBind = function (domNode, obj) {    \r\n\t    var binds = domNode.attr(bindAttrName).split(\" \");\r\n\t    for (var i = 0; i < binds.length; i++) {\r\n\t\t\tvar bind = binds[i].split(\":\");\r\n\t\t    var domAttribute = bind[0].trim(); // the attribute on the DOM element\r\n\t\t    var propertyAttribute = bind[1].trim(); // the attribute the object\r\n\t\t    var targetValue = domNode[0][domAttribute];\r\n\t\t    var resolvedPathValue = $.resolveObjectPath(obj, propertyAttribute);\r\n\t\t    if(resolvedPathValue && targetValue !== resolvedPathValue) domNode[0][domAttribute] =  resolvedPathValue;\r\n\t    }\r\n\t};\r\n\t\r\n\t/**\r\n\t * Whilst the ish.renderBind method renders values to the DOM, ish.bindToObject sets the values of the binds DOM attributes in the target object.\r\n\t * @name  ish.bindToObject\r\n\t * @function\r\n\t * @param  {String}   domNode \t\tAn exisiting DOM Node.\r\n\t * @param  {Object}   dataObject \tAn object whose values will be bound to the rendered HTML.\r\n\t * @return {ish}      Chainable with other ish methods.\r\n\t * @example\r\n\t *\r\n\t * var template = '<p ish-bind=\"textContent:text\"></p>'\r\n\t * var node = ish.renderTemplate(template, {text:'text has been rendered'});\r\n\t * // you would usualy use ish.updateTemplate, this is just for exmaple\r\n\t * ish.renderBind(node, {text: 'text has been updated text'});\r\n\t */\r\n\t$.bindToObject = function (domNode, obj){\r\n\t    var binds = domNode.attr(bindAttrName).split(\" \");\r\n\t\tfor (var i = 0; i < binds.length; i++) {\r\n\t\t\tvar bind = binds[i].split(\":\");\r\n\t\t    var domAttribute = bind[0].trim(); // the attribute on the DOM element\r\n\t\t    var propertyAttribute = bind[1].trim(); // the attribute the object\r\n\t\t    var targetValue = domNode[0][domAttribute];\r\n\t\t    if(targetValue) $.setPathByString(obj, propertyAttribute, targetValue);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t// TODO: catch refreshes?.?.?\r\n\t// TODO: \r\n\t\r\n\t(function(){\r\n\t\tvar _historyAPI = window.history;\r\n\t\r\n\t\tfunction arrayFindString(str, strArray) {\r\n\t\t\tvar matches = {\r\n\t\t\t\tvalues:[],\r\n\t\t\t\tindex:[]\r\n\t\t\t};\r\n\t\t    for (var j=0; j<strArray.length; j++) {\r\n\t\t        if (strArray[j].match(str)) {\r\n\t\t        \tmatches.index.push(j);\r\n\t\t        \tmatches.values.push(strArray[j]);\r\n\t\t        }\r\n\t\t    }\r\n\t\t    if(matches.index.length) return matches;\r\n\t\t    return -1;\r\n\t\t}\r\n\t\r\n\t\tfunction callRouteFn(routeKey, slugs, stateData) {\r\n\t\t\tvar routes = this.routes;\r\n\t\t\tif( routes.before ) routes.before( stateData );\r\n\t\t\troutes[routeKey].enter(slugs, stateData);\r\n\t\t\tif( routes.after ) routes.after( stateData );\r\n\t\t}\r\n\t\r\n\t\t// TODO: split this up in smaller more specific tasks - it's too large\r\n\t\tfunction parseURLroute (routeString, stateData){\r\n\t\t\trouteString = routeString || '';\r\n\t\t\t// get all the route keys\r\n\t\t\tvar keys = Object.keys(this.routes);\r\n\t\t\tvar routeKeys = [];\r\n\t\t\tvar wildcardKeys = keys.filter(function(item){  \r\n\t\t\t\tif(item.substr(item.length -1) === '*') {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\trouteKeys.push(item);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\t// test exact routes\r\n\t\t\tvar exact = routeKeys.indexOf(routeString);\r\n\t\t\tvar routeKey;\r\n\t\r\n\t\t\tif(exact >= 0) {\r\n\t\t\t\trouteKey =  routeKeys[exact];\r\n\t\t\t} else {\r\n\t\t\t\t// not exact\r\n\t\t\t\tvar routeArray = routeString.split('/');\r\n\t\t\t\trouteArray.shift();\r\n\t\t\t\tvar matches = arrayFindString(routeArray[0], routeKeys);\r\n\t\t\t\tvar fnIndexMatches = matches.index;\r\n\t\t\t\tvar fnKeyMatches = matches.values;\r\n\t\t\t\t\r\n\t\t\t\t// if theres more than one match refine by string comparison\r\n\t\t\t\tif(fnIndexMatches && fnIndexMatches.length > 1){\r\n\t\t\t\t\tvar refineMatch = {\r\n\t\t\t\t\t\tindex:[],\r\n\t\t\t\t\t\tvalues:[]\r\n\t\t\t\t\t}; \r\n\t\t\t\t\tvar mostPoints = 0;\r\n\t\t\t\t\tvar mostSimilar;\r\n\t\t\t\t\tfor (var i = 0; i < fnKeyMatches.length; i++) {\r\n\t\t\t\t\t\tvar newArr = fnKeyMatches[i].split('/');\r\n\t\t\t\t\t\tnewArr.shift();\r\n\t\t\t\t\t\tvar points = 0;\r\n\t\t\t\t\t\tif( newArr.length === routeArray.length){\r\n\t\t\t\t\t\t\tfor (var val = 0; val < newArr.length; val++) {\r\n\t\t\t\t\t\t\t\tif(newArr[val] === routeArray[val]){\r\n\t\t\t\t\t\t\t\t\tpoints++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(points > mostPoints) {\r\n\t\t\t\t\t\t\t\t\tmostPoints = points;\r\n\t\t\t\t\t\t\t\t\tmostSimilar = i;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(matches.index[mostSimilar]){\r\n\t\t\t\t\t\trefineMatch.index.push(matches.index[mostSimilar]);\r\n\t\t\t\t\t\trefineMatch.values.push(matches.values[mostSimilar]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmatches = refineMatch;\r\n\t\t\t\t}\r\n\t\t\t\t//console.log( 'routeString  ', routeString, matches);\r\n\t\t\t\t// only 1  match should exisit in the matches object by now.\r\n\t\t\t\tif(matches !== -1){\r\n\t\t\t\t\tif (matches.index.length === 0) { \r\n\t\t\t\t\t\tthis.routes.notFound(routeString);\r\n\t\t\t\t\t\tthis.emit('ROUTE_NOT_FOUND', { route: routeString });\r\n\t\t\t\t\t\treturn; \r\n\t\t\t\t\t} else if (matches.index.length > 1) { \r\n\t\t\t\t\t\tconsole.error('More than 1 route found'); \r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// set the current slugs and the routeKey to call\r\n\t\t\t\t\tthis.slugs = getSlugs(matches, routeArray); \r\n\t\t\t\t\trouteKey = matches.values[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif(this.current){\r\n\t\t\t\t// call previous onLeave handler\r\n\t\t\t\tvar routeFnObj = this.routes[this.current];\r\n\t\t\t\tif(routeFnObj && routeFnObj.leave) routeFnObj.leave();\r\n\t\t\t\t// call previous onLeave handler for wildcards\r\n\t\t\t\tfor (var e = 0; e < wildcardKeys.length; e++) {\r\n\t\t\t\t\tif(this.current.indexOf( wildcardKeys[e].replace('*','') ) === 0 ){\r\n\t\t\t\t\t\tvar leaveFn = this.routes[ wildcardKeys[e] ].leave;\r\n\t\t\t\t\t\tif(leaveFn) leaveFn();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar returnVal;\r\n\t\t\t// test and call wildcards\r\n\t\t\tfor (var d = 0; d < wildcardKeys.length; d++) {\r\n\t\t\t\tif(routeString.indexOf( wildcardKeys[d].replace('*','') ) === 0 ){\r\n\t\t\t\t\tcallRouteFn.call(this, wildcardKeys[d], this.slugs, stateData);\r\n\t\t\t\t\treturnVal =  {route: wildcardKeys[d], previousRoute: this.current, slugs: this.slugs };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif(routeKey){\r\n\t\t\t\t// call the single route found in the first tests\r\n\t\t\t\tcallRouteFn.call(this, routeKey, this.slugs||null, stateData);\r\n\t\t\t\treturnVal =  {route: routeString, previousRoute: this.current, slugs: this.slugs };\r\n\t\t\t}\r\n\t\t\tthis.current = routeString;\r\n\t\t\treturn returnVal;\r\n\t\t}\r\n\t\t\r\n\t\r\n\t\tfunction getSlugs(matches, routeArray){\r\n\t\t\tvar hasSlugs = false;\r\n\t\t\t// get any slug values \r\n\t\t\tvar splitMatchArray = matches.values[0].split('/');\r\n\t\t\tsplitMatchArray.shift();\r\n\t\t\t//find slugs\r\n\t\t\tvar slugs = {};\r\n\t\t\tfor (var match = 1; match < splitMatchArray.length; match++) {\r\n\t\t\t\t// is it a slug? \r\n\t\t\t\tvar isSlug = splitMatchArray[match].charAt(0) + splitMatchArray[match].charAt(splitMatchArray[match].length-1);\r\n\t\t\t\tif(isSlug === '{}') {\r\n\t\t\t\t\thasSlugs = true;\r\n\t\t\t\t\t// it's a slug!\r\n\t\t\t\t\tvar slugName =  splitMatchArray[match].slice(1,-1);\r\n\t\t\t\t\tvar slugValue = routeArray[match];\r\n\t\t\t\t\tslugs[slugName] = slugValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn hasSlugs ? slugs : null;\r\n\t\t}\r\n\t\r\n\t\tfunction setState() {\r\n\t\t\t// store the state datat in localStorage, history.state has a 640kB limit.\r\n\t\t\tvar stateString = JSON.stringify({data:$.store.data, states: $.store.states});\r\n\t\t\tlocalStorage.setItem(this.current, stateString);\r\n\t\t}\r\n\t\r\n\t\t$.fn.router = {\r\n\t\t\t/**\r\n\t\t\t * Add a route to the router instance.\r\n\t\t\t * @memberOf ish.router\r\n\t\t\t * @param {String}   route The route path you're adding.\r\n\t\t\t * @param {Object} fn    The routing object conatining 'enter' and 'leave' functions keyed by their respective name.\r\n\t\t\t * @return {ish.router}       Chainable, returns its own instance.\r\n\t\t\t */\r\n\t\t\taddRoute: function(route, fn){\r\n\t\t\t\tthis.routes[route] = fn;\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * Remove a route from the router instance.\r\n\t\t\t * @param {String}   route The route path to remove.\r\n\t\t\t * @return {ish.router}       Chainable, returns its own instance.\r\n\t\t\t */\r\n\t\t\tremoveRoute: function(route){\r\n\t\t\t\tdelete this.routes[route];\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * Flush/remove all routes from the router instance.\r\n\t\t\t * @return {ish.router}       Chainable, returns its own instance.\r\n\t\t\t */\r\n\t\t\tflushRoutes: function(){\r\n\t\t\t\tthis.routes = {};\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * Navigate to the specified route path.\r\n\t\t\t * @param {String}   route The route path to remove.\r\n\t\t\t * @return {ish.router}       Chainable, returns its own instance.\r\n\t\t\t */\r\n\t\t\tnavigate: function(route){\r\n\t\t\t\tsetState.call(this); // set state of the current page\r\n\t\t\t\tvar routeData = parseURLroute.call(this, route); // parse url route and switch pages\r\n\t\t\t\t_historyAPI.pushState(routeData, '', this.current);\r\n\t\t\t\tthis.emit('ON_NAVIGATE', routeData);\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * Destroy the router instance.\r\n\t\t\t * @return {null}   \r\n\t\t\t */\r\n\t\t\tdestroy: function(){\r\n\t\t\t\t$(window).off('popstate', this.popHandler);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tvar popHandler = function(evt){\r\n\t\t\tsetState.call(this);\r\n\t\t\t//get state\r\n\t\t\tvar route;\r\n\t\t\tvar stateData;\r\n\t\t\tif (history.state){\r\n\t\t\t\tvar historyState = history.state;\r\n\t\t\t\tstateData = JSON.parse(localStorage.getItem(historyState.route));\r\n\t\t\t\troute = parseURLroute.call(this, historyState.route, stateData);\r\n\t\t\t} else {\r\n\t\t\t\tcurrentLocation = document.URL.replace(this.baseURL,'');\r\n\t\t\t\troute = parseURLroute.call(this, currentLocation);\r\n\t\t\t}\r\n\t\t\tthis.emit('ON_POP', route);\r\n\t\t\treturn stateData;\r\n\t\t};\r\n\t\r\n\t\t/**\r\n\t\t * An application router.\r\n\t\t * @name  ish.router\r\n\t\t * @constructor\r\n\t\t * @extends {ish.emitter}\r\n\t\t * @param  {Object} options The utilities options object.\r\n\t\t * @param  {String} options.baseURL The base URL of the application.\r\n\t\t * @param  {Object} options.routes The routing object.\r\n\t\t * @return {$.router}         The router instance\r\n\t\t *\r\n\t\t * @example\r\n\t\t * var router = ish.router({ \r\n\t\t *\t\tbaseURL: 'http://ish.stateful.local',\r\n\t\t *\t\troutes: {\r\n\t\t *\t\t\tnotFound: function(url){\r\n\t\t *\t\t\t},\r\n\t\t *\t\t\tbefore: function(history){\r\n\t\t *\t\t\t\r\n\t\t *\t\t\t},\r\n\t\t *\t\t\tafter: function(history){\r\n\t\t *\t\t\t\r\n\t\t *\t\t\t},\r\n\t\t *\t\t\t'/':  {\r\n\t\t *\t\t\t\tenter: function(slugs, history){\r\n\t\t *\r\n\t\t *\t\t\t\t},\r\n\t\t *\t\t\t\tleave: function(slugs, history){\r\n\t\t *\t\t\t\t}\r\n\t\t *\t\t\t}\r\n\t\t *\t\t}\r\n\t\t * };\r\n\t\t */\r\n\t\t$.router = function(options){\r\n\t\t\tvar factory = Object.create($.fn.router);\r\n\t\t\t factory = ish.extend({}, ish.emitter(), factory, options);\r\n\t\t\tvar currentLocation = document.URL.replace(factory.baseURL,'');\r\n\t\t\t//console.log('currentLocation ',currentLocation,factory.baseURL);\r\n\t\t\tfactory.popHandler = popHandler.bind(factory);\r\n\t\t\t$(window).on('popstate', factory.popHandler);\r\n\t\t\t//parses the inital route\r\n\t\t\tparseURLroute.call(factory, currentLocation);\r\n\t\t\t// add history state for the current page\r\n\t\t\t_historyAPI.replaceState({route: factory.current, slugs: factory.slugs }, \"\", factory.current);\r\n\t\t\treturn factory;\r\n\t\t};\r\n\t\r\n\t})();\r\n\t\r\n\r\n\r\n    return $;\r\n}(document, this); "]}